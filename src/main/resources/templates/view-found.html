<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>View Found Items</title>
    <style>
        body {
            font-family: sans-serif;
            background-color: #f4f4f4;
            color: #333;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 900px;
            margin: auto;
            background: #fff;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
        }
        h1 { text-align: center; color: #23395d; }

        .item-card {
            display: flex;
            align-items: center;
            border-bottom: 1px solid #eee;
            padding: 15px 0;
            justify-content: space-between;
        }
        .item-card.highlight {
            border: 2px solid #ffcc00;
            background: #fff9e6;
            padding: 14px;
            border-radius: 6px;
        }

        .item-details { flex-grow: 1; }
        .item-image { margin-left: 20px; flex-shrink: 0; }

        .item-image img {
            max-width: 150px;
            height: auto;
            border-radius: 8px;
            border: 1px solid #ddd;
        }

        .no-image {
            width: 150px;
            height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #ddd;
            color: #888;
            text-align: center;
            border-radius: 8px;
        }

        .return-button {
            display: block;
            margin: 20px auto 0;
            padding: 10px 20px;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 5px;
            text-align: center;
            text-decoration: none;
            cursor: pointer;
        }

        /* Styles for messages */
        .message { color: green; text-align: center; font-weight: bold; margin: 15px 0; }
        .error { color: red; text-align: center; font-weight: bold; margin: 15px 0; }

        .logout-fixed {
            position: fixed;
            top: 16px;
            right: 16px;
            z-index: 999;
        }
        .logout-btn {
            background-color: #23395d;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            text-decoration: none;
            font-weight: bold;
            cursor: pointer;
        }
        .logout-btn:hover { opacity: 0.9; }
    </style>

    <script th:inline="javascript">
        /*<![CDATA[*/
        var highlightId = /*[[${highlightId}==null ? 'null' : ${highlightId}]]*/ 'null';
        window.addEventListener('DOMContentLoaded', function() {
            if (highlightId !== null && highlightId !== 'null') {
                var el = document.getElementById('item-' + highlightId);
                if (el) {
                    el.classList.add('highlight');
                    el.scrollIntoView({behavior: 'smooth', block: 'center'});
                }
            }
        });
        /*]]>*/
    </script>
</head>
<body>
<div th:if="${session.username}" class="logout-fixed">
    <a th:href="@{/logout}" class="logout-btn">Logout</a>
</div>

<div class="container">
    <h1>All Found Items</h1>

    <p th:if="${message}" th:text="${message}" class="message"></p>
    <p th:if="${error}" th:text="${error}" class="error"></p>

    <div th:if="${#lists.isEmpty(foundItems)}" style="text-align: center; color: #888; margin: 30px 0;">
        No items found.
    </div>

    <div th:each="item : ${foundItems}" th:attr="id=${'item-' + item.id}" class="item-card">
        <div class="item-details">
            <p><strong>Item Name:</strong> <span th:text="${item.itemName}">-</span></p>
            <p><strong>Description:</strong> <span th:text="${item.description}"></span></p>
            <p><strong>Location:</strong> <span th:text="${item.location}"></span></p>
            <p><strong>Status:</strong> <span th:text="${item.status}"></span></p>
            <p><strong>Date Found:</strong> <span th:text="${item.dateFound}"></span></p>

            <div th:if="${item.status == 'PENDING'}">
                <a th:href="@{/get-contact/{id}(id=${item.id})}">
                    <button style="margin-top: 10px; padding: 8px 15px; border: none; border-radius: 4px; color: white; background-color: #28a745; cursor: pointer;">View Contact Details</button>
                </a>
            </div>

            <div th:if="${item.status == 'AWAITING_DELETION'}">
                <p style="color: #ff9900; font-weight: bold; margin-top: 10px;">Confirmation Pending from Reporter.</p>
            </div>
        </div>

        <div class="item-image">
            <div th:if="${item.imagePath}" class="image-container">
                <img th:src="${item.imagePath}" alt="Found Item Image"/>
            </div>
            <div th:unless="${item.imagePath}" class="no-image">
                No Image
            </div>
        </div>
    </div>

    <a href="/selection" class="return-button">Return to Dashboard</a>
</div>
</body>
</html>
